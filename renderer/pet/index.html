<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <style>
    html, body { 
      margin: 0; 
      padding: 0; 
      background: transparent; 
      overflow: hidden;
      width: 128px;
      height: 128px;
    }
    
    #pet {
      position: absolute;
      width: 100px;
      height: 100px;
      top: 14px;
      left: 14px;
      transition: transform 0.1s ease-out;
    }
    
    #pet-sprite {
      width: 100%;
      height: 100%;
      object-fit: contain;
      image-rendering: pixelated;
      pointer-events: none; /* é˜²æ­¢åœ–ç‰‡è¢«æ‹–æ‹½ */
      user-select: none; /* é˜²æ­¢é¸å– */
      -webkit-user-drag: none; /* é˜²æ­¢æ‹–æ‹½ */
    }
    
    .bounce {
      transform: scale(1.2) !important;
    }
  </style>
</head>
<body>
  <div id="pet">
    <img id="pet-sprite" src="" alt="æ¡Œå¯µ" />
  </div>
  
  <script>
    // æ‰‹ç¹ª PNG åœ–æª”é…ç½® - æ ¹æ“š README.md èªªæ˜
    const handdrawnSprites = {
      // ç¡è¦ºå¾…æ©Ÿå‹•ç•«ï¼š1-6 å¾ªç’°
      idle: [
        'sprites/idle_sleeping/idle_sleeping_1.PNG',
        'sprites/idle_sleeping/idle_sleeping_2.PNG',
        'sprites/idle_sleeping/idle_sleeping_3.PNG',
        'sprites/idle_sleeping/idle_sleeping_4.PNG',
        'sprites/idle_sleeping/idle_sleeping_5.PNG',
        'sprites/idle_sleeping/idle_sleeping_6.PNG'
      ],
      // è¡Œèµ°å‹•ç•«ï¼š1-7 å¾ªç’°ï¼ˆé¢å‘å·¦ï¼Œå¯è‡ªå‹•ç¿»è½‰ï¼‰
      walk: [
        'sprites/walking/walking_1.PNG',
        'sprites/walking/walking_2.PNG',
        'sprites/walking/walking_3.PNG',
        'sprites/walking/walking_4.PNG',
        'sprites/walking/walking_5.PNG',
        'sprites/walking/walking_6.PNG',
        'sprites/walking/walking_7.PNG'
      ],
      // æ¸…é†’å‹•ç•«ï¼š1-8 (æ»‘é¼ é»æ“Šå«é†’æ™‚ä½¿ç”¨)
      awake: [
        'sprites/awake/awake_1.PNG',
        'sprites/awake/awake_2.PNG',
        'sprites/awake/awake_3.PNG',
        'sprites/awake/awake_4.PNG',
        'sprites/awake/awake_5.PNG',
        'sprites/awake/awake_6.PNG',
        'sprites/awake/awake_7.PNG',
        'sprites/awake/awake_8.PNG'
      ],
      // å½ˆè·³å‹•ç•«ï¼ˆæš«æ™‚ä½¿ç”¨ç¬¬ä¸€å¹€ï¼‰
      bounce: ['sprites/walking/walking_1.PNG'],
      // ç¡è¦ºå‹•ç•«ï¼ˆä½¿ç”¨ idle_sleeping çš„ç¬¬ä¸€å¹€ï¼‰
      sleep: ['sprites/idle_sleeping/idle_sleeping_1.PNG']
    };
    
    // PNG/SVG åœ–æª”é…ç½® - ç›®å‰ä½¿ç”¨SVGï¼Œä½†æ”¯æ´PNG
    const sprites = {
      idle: ['sprites/idle_1.svg', 'sprites/idle_2.svg'],
      walk: ['sprites/walk_1.svg', 'sprites/walk_1.svg'],
      bounce: ['sprites/bounce_1.svg'],
      sleep: ['sprites/idle_2.svg']
    };
    
    // å¦‚æœæœ‰PNGæª”æ¡ˆï¼Œæœƒå„ªå…ˆä½¿ç”¨PNG
    const pngSprites = {
      idle: ['sprites/idle_1.png', 'sprites/idle_2.png'],
      walk: ['sprites/walk_1.png', 'sprites/walk_1.png'],
      bounce: ['sprites/bounce_1.png'],
      sleep: ['sprites/idle_2.png']
    };
    
    // æœ€çµ‚å‚™ç”¨ - å…§å»ºSVG
    const defaultSprite = 'data:image/svg+xml;base64,' + btoa(`
      <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
        <circle cx="50" cy="50" r="40" fill="#ff6b6b" stroke="#fff" stroke-width="3"/>
        <circle cx="38" cy="40" r="6" fill="white"/>
        <circle cx="62" cy="40" r="6" fill="white"/>
        <circle cx="38" cy="40" r="3" fill="black"/>
        <circle cx="62" cy="40" r="3" fill="black"/>
        <path d="M 35 60 Q 50 70 65 60" stroke="#fff" stroke-width="2" fill="none"/>
      </svg>
    `);
    
    let currentState = 'walk';
    let animationFrame = 0;
    let lastFrameTime = Date.now();
    const petSprite = document.getElementById('pet-sprite');
    const petElement = document.getElementById('pet');
    
    // ç§»å‹•é‚è¼¯ï¼ˆåŸºæ–¼æˆåŠŸçš„ç°¡å–®ç‰ˆæœ¬ï¼‰
    let x = 100, y = 100;
    let vx = 3, vy = 2;
    let dragging = false;
    let lastInteractionTime = Date.now();
    let isPaused = false; // æ°¸ä¹…æš«åœç‹€æ…‹ï¼ˆéœ€æ‰‹å‹•æ¢å¾©ï¼‰
    let isTemporaryPaused = false; // æš«æ™‚åœæ­¢ç‹€æ…‹ï¼ˆå³éµå¯æ¢å¾©ï¼‰
    let isContextMenuOpen = false; // è¿½è¹¤å³éµé¸å–®æ˜¯å¦é–‹å•Ÿ
    
    function loadSprite(...spritePaths) {
      return new Promise((resolve) => {
        function tryLoadSprite(index) {
          if (index >= spritePaths.length) {
            resolve(defaultSprite); // å¦‚æœæ‰€æœ‰è·¯å¾‘éƒ½å¤±æ•—ï¼Œä½¿ç”¨é è¨­
            return;
          }
          
          const img = new Image();
          img.onload = () => resolve(spritePaths[index]);
          img.onerror = () => tryLoadSprite(index + 1); // å˜—è©¦ä¸‹ä¸€å€‹
          img.src = spritePaths[index];
        }
        
        tryLoadSprite(0);
      });
    }
    
    async function updateSprite() {
      // å„ªå…ˆä½¿ç”¨æ‰‹ç¹ªåœ–ç‰‡ï¼Œç„¶å¾Œæ˜¯ PNGï¼Œæœ€å¾Œæ˜¯ SVG
      const handdrawnStateSprites = handdrawnSprites[currentState] || handdrawnSprites.idle;
      const stateSprites = sprites[currentState] || sprites.idle;
      const pngStateSprites = pngSprites[currentState] || pngSprites.idle;
      
      const spriteIndex = animationFrame % handdrawnStateSprites.length;
      const handdrawnSprite = handdrawnStateSprites[spriteIndex];
      const svgSprite = stateSprites[spriteIndex % stateSprites.length];
      const pngSprite = pngStateSprites[spriteIndex % pngStateSprites.length];
      
      // å„ªå…ˆé †åºï¼šæ‰‹ç¹ª PNG -> ä¸€èˆ¬ PNG -> SVG -> é è¨­
      const finalSprite = await loadSprite(handdrawnSprite, pngSprite, svgSprite);
      petSprite.src = finalSprite;
    }
    
    function setPetState(newState) {
      currentState = newState;
      animationFrame = 0;
      updateSprite();
    }
    
    function animateFrames() {
      const now = Date.now();
      if (now - lastFrameTime > 400) { // æ¯400msåˆ‡æ›ä¸€å¹€
        animationFrame++;
        lastFrameTime = now;
        updateSprite();
      }
    }
    
    function move() {
      if (dragging || isPaused || isTemporaryPaused || isContextMenuOpen) return; // ç§»é™¤ isDesktopFocused æª¢æŸ¥
      
      x += vx;
      y += vy;
      
      let bounced = false;
      // æ”¹é€²çš„é‚Šç•Œæª¢æ¸¬ - æ›´åš´æ ¼çš„é‚Šç•Œ
      if (x < 10) { 
        x = 10;
        vx = -vx; 
        bounced = true; 
      }
      if (x > 1200) { 
        x = 1200;
        vx = -vx; 
        bounced = true; 
      }
      if (y < 10) { 
        y = 10;
        vy = -vy; 
        bounced = true; 
      }
      if (y > 800) { 
        y = 800;
        vy = -vy; 
        bounced = true; 
      }
      
      // ä½¿ç”¨electronAPIç§»å‹•è¦–çª—
      if (window.electronAPI) {
        window.electronAPI.moveWindow(x, y);
      }
      
      if (bounced) {
        petElement.classList.add('bounce');
        setPetState('bounce');
        setTimeout(() => {
          petElement.classList.remove('bounce');
          setPetState('walk');
        }, 300);
      }
    }
    
    // æ»‘é¼ äº’å‹•è®Šæ•¸
    let mouseStartX, mouseStartY;
    let isMouseOver = false;
    
    // æ»‘é¼ äº’å‹•è™•ç†å‡½æ•¸
    function handleMouseEnter() {
      console.log('=== Mouse enter pet ===');
      console.log('è¨­ç½®æ»‘é¼ ç©¿é€: false');
      isMouseOver = true;
      if (window.electronAPI) {
        window.electronAPI.setMouseThrough(false);
      }
      lastInteractionTime = Date.now();
    }

    function handleMouseLeave() {
      console.log('=== Mouse leave pet ===');
      console.log('dragging:', dragging);
      console.log('isContextMenuOpen:', isContextMenuOpen);
      console.log('æº–å‚™è¨­ç½®æ»‘é¼ ç©¿é€: true');
      isMouseOver = false;
      // åªæœ‰åœ¨ä¸æ‹–æ‹½ä¸”æ²’æœ‰é–‹å•Ÿå³éµé¸å–®æ™‚æ‰å•Ÿç”¨ç©¿é€
      if (!dragging && !isContextMenuOpen && window.electronAPI) {
        window.electronAPI.setMouseThrough(true);
        setPetState('walk');
        console.log('æ»‘é¼ ç©¿é€å·²è¨­ç½®ç‚º true');
      } else {
        console.log('æœªè¨­ç½®æ»‘é¼ ç©¿é€ï¼Œdragging:', dragging, 'isContextMenuOpen:', isContextMenuOpen);
      }
    }

    // æ»‘é¼ äº’å‹•
    petElement.addEventListener('mouseenter', handleMouseEnter);
    petElement.addEventListener('mouseleave', handleMouseLeave);

    // æ‹–æ‹½é–‹å§‹äº‹ä»¶ - ç«‹å³éŸ¿æ‡‰
    petElement.addEventListener('mousedown', (e) => {
      e.preventDefault();
      e.stopPropagation();

      // check for left click
      if (e.button === 0) {
        console.log('Mouse down - starting drag');
        
        // ç«‹å³è¨­ç½®æ‹–æ‹½ç‹€æ…‹
        dragging = true;
        window.lastDragStart = Date.now();
        mouseStartX = e.clientX;
        mouseStartY = e.clientY;
        setPetState('idle');
        
        // ç«‹å³ç¦ç”¨æ»‘é¼ ç©¿é€
        if (window.electronAPI) {
          window.electronAPI.setMouseThrough(false);
        }
      }

      // check for right click
      if (e.button === 2) {
        // å³éµé»æ“Šä¸ç›´æ¥é–‹å•Ÿå°è©±æ¡†ï¼Œç”± contextmenu äº‹ä»¶è™•ç†
        return;
      }
    });    // é˜²æ­¢åœ–ç‰‡æ‹–æ‹½
    petSprite.addEventListener('dragstart', (e) => {
      e.preventDefault();
      return false;
    });
    
    petSprite.addEventListener('selectstart', (e) => {
      e.preventDefault();
      return false;
    });
    
    // ç¯€æµçš„æ‹–æ‹½ç§»å‹•è™•ç†
    let moveTimeout = null;
    window.addEventListener('mousemove', (e) => {
      if (dragging && mouseStartX !== undefined && mouseStartY !== undefined) {
        const deltaX = e.clientX - mouseStartX;
        const deltaY = e.clientY - mouseStartY;
        
        // ç«‹å³æ›´æ–°ä½ç½®è®Šæ•¸
        x += deltaX;
        y += deltaY;
        mouseStartX = e.clientX;
        mouseStartY = e.clientY;
        
        // ç¯€æµè¦–çª—ç§»å‹•è«‹æ±‚
        if (moveTimeout) {
          clearTimeout(moveTimeout);
        }
        
        moveTimeout = setTimeout(() => {
          if (window.electronAPI) {
            window.electronAPI.moveWindow(x, y);
          }
          moveTimeout = null;
        }, 8); // 8ms ç¯€æµï¼Œç´„ 120fps
      }
    });

    // å¿«é€ŸéŸ¿æ‡‰çš„ mouseup è™•ç†
    window.addEventListener('mouseup', (e) => {
      if (e.button === 2) {
        return; // å³éµä¸è™•ç†
      }
      
      if (dragging) {
        console.log('Mouse up - ending drag');
        
        // ç«‹å³é‡ç½®æ‹–æ‹½ç‹€æ…‹
        dragging = false;
        mouseStartX = undefined;
        mouseStartY = undefined;
        setPetState('walk');
        
        // æ ¹æ“šæ»‘é¼ ä½ç½®æ±ºå®šç©¿é€ç‹€æ…‹
        if (window.electronAPI) {
          if (isMouseOver) {
            // æ»‘é¼ é‚„åœ¨å¯µç‰©ä¸Šï¼Œä¿æŒå¯äº’å‹•
            window.electronAPI.setMouseThrough(false);
          } else {
            // æ»‘é¼ ä¸åœ¨å¯µç‰©ä¸Šï¼Œå•Ÿç”¨ç©¿é€
            window.electronAPI.setMouseThrough(true);
          }
        }
      }
    });

    // åŒæ™‚ç›£è½ petElement çš„ mouseupï¼Œç¢ºä¿å¿«é€Ÿé»æ“Šè¢«æ•ç²
    petElement.addEventListener('mouseup', (e) => {
      if (dragging) {
        console.log('Pet mouseup - ending drag');
        
        // ç«‹å³é‡ç½®æ‹–æ‹½ç‹€æ…‹
        dragging = false;
        mouseStartX = undefined;
        mouseStartY = undefined;
        setPetState('walk');
        
        // æ»‘é¼ åœ¨å¯µç‰©ä¸Šï¼Œä¿æŒå¯äº’å‹•
        if (window.electronAPI) {
          window.electronAPI.setMouseThrough(false);
        }
      }
    });

    // è¦–çª—ç„¦é»è™•ç†
    window.addEventListener('blur', () => {
      if (dragging) {
        dragging = false;
        mouseStartX = undefined;
        mouseStartY = undefined;
        if (window.electronAPI) {
          window.electronAPI.setMouseThrough(true);
        }
        setPetState('walk');
      }
    });

    // ç°¡å–®çš„æ‹–æ‹½è¶…æ™‚ä¿è­·
    setInterval(() => {
      if (dragging && window.lastDragStart && (Date.now() - window.lastDragStart > 10000)) {
        dragging = false;
        mouseStartX = undefined;
        mouseStartY = undefined;
        if (window.electronAPI) {
          window.electronAPI.setMouseThrough(true);
        }
        setPetState('walk');
      }
    }, 5000);

    // æ–°å¢ï¼šå…¨åŸŸæ»‘é¼ ç›£è½ï¼Œé˜²æ­¢æ»‘é¼ äº‹ä»¶ä¸Ÿå¤±
    document.addEventListener('mouseenter', () => {
      console.log('Document mouse enter');
    });
    
    document.addEventListener('mouseleave', () => {
      console.log('Document mouse leave');
      // å¦‚æœæ»‘é¼ å®Œå…¨é›¢é–‹è¦–çª—å€åŸŸï¼Œç¢ºä¿ç©¿é€ç‹€æ…‹æ­£ç¢º
      if (!dragging && window.electronAPI) {
        setTimeout(() => {
          if (!dragging) {
            window.electronAPI.setMouseThrough(true);
          }
        }, 100);
      }
    });
    
    // å³éµäº‹ä»¶è™•ç†å‡½æ•¸
    function handleContextMenu(e) {
      console.log('=== å³éµäº‹ä»¶è§¸ç™¼ ===');
      console.log('äº‹ä»¶å°è±¡:', e);
      console.log('ç•¶å‰æ™‚é–“:', new Date().toLocaleTimeString());
      console.log('isContextMenuOpen:', isContextMenuOpen);
      console.log('isMouseOver:', isMouseOver);
      console.log('dragging:', dragging);
      
      e.preventDefault(); // é˜²æ­¢é¡¯ç¤ºé è¨­å³éµèœå–®
      e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
      
      console.log('å³éµé»æ“Šï¼Œç•¶å‰é¸å–®ç‹€æ…‹:', isContextMenuOpen);
      
      // å¦‚æœé¸å–®å·²ç¶“é–‹å•Ÿï¼Œå…ˆé—œé–‰å®ƒ
      if (isContextMenuOpen) {
        console.log('é¸å–®å·²é–‹å•Ÿï¼Œé‡ç½®ç‹€æ…‹');
        isContextMenuOpen = false;
      }
      
      // å³éµæ™‚æš«åœç§»å‹•
      isContextMenuOpen = true;
      setPetState('idle');
      
      // ç›´æ¥é¡¯ç¤ºåŸç”Ÿé¸å–®
      if (window.electronAPI) {
        window.electronAPI.showContextMenu();
      }
      
      console.log('é¡¯ç¤ºå³éµé¸å–®ï¼Œæ¡Œå¯µæš«åœç§»å‹•');
    }

    // ç¶å®šå³éµäº‹ä»¶è™•ç† - ä½¿ç”¨åŸç”Ÿé¸å–®
    petElement.addEventListener('contextmenu', handleContextMenu);
    
    // å•Ÿå‹•
    setTimeout(() => {
      if (window.electronAPI) {
        console.log('Starting PNG pet...');
        console.log('ğŸ”¥ å°æç¤ºï¼šå¦‚æœæ‹–æ‹½å¤±æ•ˆï¼ŒæŒ‰ Esc éµé‡æ–°å•Ÿå‹•æ¡Œå¯µç„¦é»ï¼');
        setPetState('walk');
        setInterval(move, 50); // ç§»å‹•æ›´æ–°
        setInterval(animateFrames, 100); // å‹•ç•«æ›´æ–°
        
        // å¯¦éš›é‡ç½®é¸å–®ç‹€æ…‹çš„å‡½æ•¸
        function resetContextMenu() {
          console.log('å®‰å…¨æª¢æŸ¥ï¼šé¸å–®ç‹€æ…‹å¯èƒ½ç•°å¸¸ï¼Œå·²è‡ªå‹•é‡ç½®');
          isContextMenuOpen = false;
          if (typeof closeContextMenu === 'function') {
            closeContextMenu();
          }
        }
        
        setInterval(() => {
          // å¦‚æœé¸å–®é–‹å•Ÿè¶…é 10 ç§’ï¼Œå¯èƒ½æœ‰å•é¡Œï¼Œè‡ªå‹•é‡ç½®
          if (isContextMenuOpen) {
            resetContextMenu();
          }
        }, 10000);
        
        // åˆå§‹åŒ–æ»‘é¼ ç©¿é€ç‹€æ…‹
        window.electronAPI.setMouseThrough(true);
        
        // ç›£è½ä¸»é€²ç¨‹çš„æ‹–æ‹½é‡ç½®è¨Šæ¯
        if (window.electronAPI.onResetDragState) {
          window.electronAPI.onResetDragState(() => {
            console.log('Received reset drag state command from main process');
            if (dragging) {
              dragging = false;
              setPetState('walk');
            }
          });
        }
        
        // ç›£è½ä¸»é€²ç¨‹çš„é¸å–®æ“ä½œè¨Šæ¯
        if (window.electronAPI.onPetBounce) {
          window.electronAPI.onPetBounce(() => {
            setPetState('bounce');
            setTimeout(() => setPetState('walk'), 500);
          });
        }
        
        if (window.electronAPI.onTogglePermanentPause) {
          window.electronAPI.onTogglePermanentPause((event, pauseState) => {
            isPaused = pauseState;
            isTemporaryPaused = false;
            if (pauseState) {
              setPetState('idle');
              console.log('æ¡Œå¯µå·²æš«åœ');
            } else {
              setPetState('walk');
              console.log('æ¡Œå¯µå·²æ¢å¾©ç§»å‹•');
            }
          });
        }
        
        // ç›£è½ç„¦é»åˆ‡æ›äº‹ä»¶
        if (window.electronAPI.onFocusChanged) {
          window.electronAPI.onFocusChanged((event, appName) => {
            console.log('æ‡‰ç”¨ç„¦é»åˆ‡æ›åˆ°:', appName);
            // ç„¦é»åˆ‡æ›æ™‚çš„è™•ç†å¯ä»¥åœ¨é€™è£¡æ·»åŠ 
          });
        }
        
        if (window.electronAPI.onDesktopFocused) {
          window.electronAPI.onDesktopFocused(() => {
            console.log('æ¡Œé¢ç²å¾—ç„¦é» - æ¡Œå¯µä¿æŒåŸç‹€æ…‹');
            // ä¸æ”¹è®Šç§»å‹•ç‹€æ…‹ï¼Œåªè¨˜éŒ„ç„¦é»ç‹€æ…‹
          });
        }
        
        // ç›£è½è¦–çª—é‡æ–°ç²å¾—ç„¦é»
        window.addEventListener('focus', () => {
          console.log('æ¡Œå¯µè¦–çª—é‡æ–°ç²å¾—ç„¦é»');
          // å®‰å…¨é‡ç½®ï¼šå¦‚æœé¸å–®ç‹€æ…‹ç•°å¸¸ï¼Œé‡ç½®å®ƒ
          if (isContextMenuOpen) {
            console.log('å®‰å…¨é‡ç½®ï¼šé‡ç½®é¸å–®ç‹€æ…‹');
            isContextMenuOpen = false;
          }
          // ä¸éœ€è¦ç‰¹åˆ¥è™•ç†ï¼Œæ¡Œå¯µæœƒæ ¹æ“šåŸæœ¬çš„ç‹€æ…‹ç¹¼çºŒé‹ä½œ
        });
        
        // ç›£è½å³éµé¸å–®é—œé–‰äº‹ä»¶
        if (window.electronAPI.onContextMenuClosed) {
          window.electronAPI.onContextMenuClosed(() => {
            console.log('=== å³éµé¸å–®å·²é—œé–‰ ===');
            console.log('é—œé–‰å‰ isContextMenuOpen:', isContextMenuOpen);
            console.log('isMouseOver:', isMouseOver);
            isContextMenuOpen = false;
            
            // å®Œå…¨é‡æ–°åˆå§‹åŒ–æ•´å€‹äº‹ä»¶ç³»çµ±
            console.log('å®Œå…¨é‡æ–°åˆå§‹åŒ–äº‹ä»¶ç³»çµ±');
            
            // ç§»é™¤æ‰€æœ‰æ»‘é¼ äº‹ä»¶ç›£è½å™¨
            petElement.removeEventListener('contextmenu', handleContextMenu);
            petElement.removeEventListener('mouseenter', handleMouseEnter);
            petElement.removeEventListener('mouseleave', handleMouseLeave);
            
            // å¼·åˆ¶é‡ç½®æ‰€æœ‰ç‹€æ…‹
            isMouseOver = false;
            dragging = false;
            
            // å¼·åˆ¶é‡ç½®æ»‘é¼ ç‹€æ…‹
            if (window.electronAPI.forceResetMouseState) {
              console.log('åŸ·è¡Œå¼·åˆ¶é‡ç½®æ»‘é¼ ç‹€æ…‹');
              window.electronAPI.forceResetMouseState();
            }
            
            // å»¶é²é‡æ–°ç¶å®šæ‰€æœ‰äº‹ä»¶ç›£è½å™¨
            setTimeout(() => {
              console.log('é‡æ–°ç¶å®šæ‰€æœ‰äº‹ä»¶ç›£è½å™¨');
              petElement.addEventListener('contextmenu', handleContextMenu);
              petElement.addEventListener('mouseenter', handleMouseEnter);
              petElement.addEventListener('mouseleave', handleMouseLeave);
              
              // æ¨¡æ“¬ mouseenter é‡ç½®ç‹€æ…‹
              console.log('æ¨¡æ“¬ mouseenter é‡ç½®ç‹€æ…‹');
              handleMouseEnter();
            }, 100);
            
            // å¦‚æœæ²’æœ‰å…¶ä»–æš«åœç‹€æ…‹ï¼Œæ¢å¾©ç§»å‹•ï¼ˆä¸è€ƒæ…®æ¡Œé¢ç„¦é»ï¼‰
            if (!isPaused && !isTemporaryPaused) {
              console.log('æ¢å¾©æ¡Œå¯µç§»å‹•');
              setPetState('walk');
            } else {
              console.log('ä¸æ¢å¾©ç§»å‹•ï¼ŒisPaused:', isPaused, 'isTemporaryPaused:', isTemporaryPaused);
            }
          });
        }
      } else {
        console.error('electronAPI not found');
        petSprite.src = defaultSprite;
      }
    }, 500);
  </script>
</body>
</html>